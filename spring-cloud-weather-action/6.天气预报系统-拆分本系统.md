# 6.天气预报系统-拆分本系统

![image](https://hexo-1256188416.cos.ap-shanghai.myqcloud.com/weather-spring-cloud-action/%E5%9B%9B%E4%B8%AA%E5%BE%AE%E6%9C%8D%E5%8A%A1.png?q-sign-algorithm=sha1&q-ak=AKIDWqvkLgucCakfMqE5rPjodEZeT3OTQtJa&q-sign-time=1542777868;1542778768&q-key-time=1542777868;1542778768&q-header-list=&q-url-param-list=&q-signature=646ae72797a3a993dd91d9e1515b08e789e35f4e)

## 天气数据采集微服务

这个微服务专门提供数据采集和定时更新功能，将数据存储在redis中。

![image](https://hexo-1256188416.cos.ap-shanghai.myqcloud.com/weather-spring-cloud-action/msa-weather-collection-server.png?q-sign-algorithm=sha1&q-ak=AKIDWqvkLgucCakfMqE5rPjodEZeT3OTQtJa&q-sign-time=1542778427;1542779327&q-key-time=1542778427;1542779327&q-header-list=&q-url-param-list=&q-signature=f2f70bdcd43a20f1c66db00e6ecd89b27c6b81f9)

该服务的核心service中的方法是：`syncDataByCityId`，就是根据`cityId`来将数据同步进redis。

代码：https://gitee.com/_swg/weather-action-spring-cloud/tree/master/msa-weather-collection-server


## 天气数据API

这个服务专门来提供天气数据的查询功能。

将前端页面以及定时、城市相关的代码全部剔除。只留下两个API：

```java
WeatherResponse getDataByCityId(String cityId);

WeatherResponse getDataByCityName(String cityName);
```

代码：https://gitee.com/_swg/weather-action-spring-cloud/tree/master/msa-weather-data-server

## 天气预报微服务

本服务的主要功能为：用户通过浏览器来访问，可以返回一个天气预报的界面。

就将redis和定时任务相关的都删掉。我们只需要一个接口：
```java
Weather getDataByCityId(String cityId);
```

因为展示数据需要用到城市信息，但是此时还没有，所以需要自己去模拟一些数据去显示。

代码：https://gitee.com/_swg/weather-action-spring-cloud/tree/master/msa-weather-report-server


## 城市数据API

本服务只提供城市列表数据功能。

```java
List<City> listCity() throws Exception;
```

有的需要填充一些假数据之后，都可以独立运行。

代码：https://gitee.com/_swg/weather-action-spring-cloud/tree/master/msa-weather-city-server